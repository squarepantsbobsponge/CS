![image-20240506113933705](C:\Users\ä¸æ™“çª\AppData\Roaming\Typora\typora-user-images\image-20240506113933705.png)

 

 

â€‹												æœ¬ç§‘ç”Ÿå®éªŒæŠ¥å‘Š

â€‹										å­¦ç”Ÿå§“åï¼š      ä¸æ™“çª

â€‹										å­¦ç”Ÿå­¦å·ï¼š       22336057

â€‹										ä¸“ä¸šåç§°ï¼š	è®¡ç§‘

[TOC]

## ä¸€ï¼šPCAé™ä½å›¾åƒç‰¹å¾ç»´åº¦

ç”±äºæ ·æœ¬çš„å›¾åƒä¸º784ç»´ï¼Œåˆ™éœ€è¦å¯¹å›¾åƒé™ç»´å¤„ç†
#### (1). ç®—æ³•æµç¨‹

1. å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡Œæ•°æ®ä¸­å¿ƒåŒ–ï¼Œ$X_{\text{centered}} = X - \bar{X}$
2. æ±‚è®­ç»ƒæ•°æ®ä¸­å¿ƒåŒ–åçš„åæ–¹å·®çŸ©é˜µï¼š$ C = \frac{1}{m} X_{\text{centered}}^T X_{\text{centered}}$
3. å¯¹è¯¥åæ–¹å·®çŸ©é˜µè®¡ç®—ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
   * é€‰æ‹©ä¸»æˆåˆ†ï¼šæ ¹æ®ç‰¹å¾å€¼çš„å¤§å°ï¼Œé€‰æ‹©å‰ *n*components ä¸ªæœ€å¤§çš„ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ä½œä¸ºä¸»æˆåˆ†ã€‚è¿™äº›ç‰¹å¾å‘é‡æ„æˆäº†ä¸€ä¸ªè½¬æ¢çŸ©é˜µ *W*ã€‚

4. æ•°æ®è½¬åŒ–ï¼šå°†åŸå§‹è®­ç»ƒæ•°æ®å’ŒåŸå§‹æµ‹è¯•æ•°æ®æŠ•å½±åˆ°ä¸»æˆåˆ†ç©ºé—´ä¸Šï¼Œå¾—åˆ°é™ç»´åçš„æ•°æ®$   X_{\text{reduced}} = X_{\text{centered}} W$â€‹


#### (2). å…·ä½“å®ç°

```python
class PCA():
    def __init__(self):
        self.mean=None
        self.components=None
    
    def fit(self,X,n_components):
        # åŠŸèƒ½ï¼šæ ¹æ®Xè®¡ç®—n_componentsä¸ªä¸»æˆåˆ†å‘é‡
        m,n=X.shape
        # 1 æ±‚åæ–¹å·®çŸ©é˜µ
        self.mean=np.mean(X,axis=0)
        X_centered=X-self.mean #ä¼šå¹¿æ’­çš„
        covariance_matrix=np.matmul(X_centered.T,X_centered)/m
        # 2.è®¡ç®—ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼ˆåˆ—å‘é‡ï¼‰
        eigenvalues,eigenvectors=np.linalg.eig(covariance_matrix)
        # 3.å–å‡ºæœ€å¤§çš„å‰nä¸ªç‰¹å¾å‘é‡
            #å°†ç‰¹å¾å‘é‡æœ€å¤§åˆ°å°çš„ç´¢å¼•æ‰¾å‡ºæ¥
        index=np.argsort(eigenvalues)[::-1]
            #æ’åº
        eigenvectors=eigenvectors[:,index]
        #   é€‰æ‹©å‰nä¸ªç‰¹å¾å‘é‡
        self.components=eigenvectors[:,:n_components]

    def transform(self,X):
        # åŠŸèƒ½ï¼šå°†å‘é‡è½¬åˆ°ä¸»æˆåˆ†ç©ºé—´
        return np.dot(X-self.mean,self.components)
```

zh

## äºŒï¼šKmeans

#### (1).ç®—æ³•æµç¨‹(å‚æ•°åˆå§‹åŒ–æ–¹æ³•)ï¼š

1. åˆå§‹åŒ–é˜¶æ®µï¼šé€‰æ‹©kä¸ªåˆå§‹èšç±»ä¸­å¿ƒï¼ˆå¦‚æœè¦åˆ’åˆ†ä¸ºkä¸ªèšç±»ï¼‰

   èšç±»ä¸­å¿ƒçš„åˆå§‹åŒ–ï¼š

   * æ³•ä¸€ï¼šéšæœºé€‰æ‹©è®­ç»ƒæ ·æœ¬å†…çš„kä¸ªé¡¶ç‚¹ä¸ºkä¸ªèšç±»çš„åˆå§‹åŒ–ä¸­å¿ƒ

     ```python
         def init_center_random(self):
             # åŠŸèƒ½ï¼šéšæœºä»è®­ç»ƒå®ä¾‹ä¸­æŒ‘é€‰10ä¸ªæ ·æœ¬åˆå§‹åŒ–èšç±»ä¸­å¿ƒ
             init_num = np.random.choice(self.train_images.shape[0], self.k, replace=False)
             self.centers= self.train_images[init_num]
     ```

   * æ³•äºŒï¼š

     * æ€æƒ³ï¼šä¾æ®è·ç¦»åˆå§‹åŒ–èšç±»ä¸­å¿ƒï¼Œä½¿å¾—èšç±»ä¸­å¿ƒå°½å¯èƒ½åˆ†æ•£ã€‚

     * å®ç°ï¼šå…ˆéšæœºä»æ ·æœ¬ä¸­æŒ‘é€‰å‡ºä¸€ä¸ªç‚¹ä¸ºç¬¬ä¸€ä¸ªèšç±»ä¸­å¿ƒï¼Œç„¶ååœ¨æ ·æœ¬ä¸­é€‰å‡ºç¦»å½“å‰å·²å­˜åœ¨èšç±»ä¸­å¿ƒæœ€è¿œçš„æ ·æœ¬ä¸ºæ–°çš„èšç±»ä¸­å¿ƒï¼Œç›´åˆ°å­˜åœ¨kä¸ªèšç±»ä¸­å¿ƒä¸ºæ­¢

       ```python
           def init_center_distance(self):
               # åŠŸèƒ½ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–èšç±»ä¸­å¿ƒ
               # 1. é€‰æ‹©ç¬¬ä¸€ä¸ªä¸­å¿ƒç‚¹ä¸ºéšæœºæ ·æœ¬
               self.centers = np.zeros((self.k, self.train_images.shape[1]))
               self.centers[0] = self.train_images[np.random.choice(self.train_images.shape[0])]
               # 2. è®¡ç®—æ‰€æœ‰ç‚¹åˆ°ç¬¬ä¸€ä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»
               distances = np.linalg.norm(self.train_images - self.centers[0], axis=1)
               # 3. é€‰æ‹©å‰©ä½™çš„ä¸­å¿ƒç‚¹
               for i in range(1, self.k):
                   # é€‰æ‹©ä¸å·²æœ‰ä¸­å¿ƒç‚¹è·ç¦»æœ€è¿œçš„ç‚¹ä½œä¸ºæ–°çš„ä¸­å¿ƒç‚¹
                   farthest_index = np.argmax(distances)
                   self.centers[i] = self.train_images[farthest_index]
                   # æ›´æ–°è·ç¦»ï¼Œè€ƒè™‘æ–°ä¸­å¿ƒç‚¹
                   new_distances = np.linalg.norm(self.train_images - self.centers[i], axis=1)
                   # æ›´æ–°åˆ°æ–°ä¸­å¿ƒç‚¹çš„è·ç¦»
                   distances = np.minimum(distances, new_distances)
       ```

       

2. è¿­ä»£é˜¶æ®µï¼š
       åœ¨`Kmeans.train()`ä¸­å®ç°:

   * è®¡ç®—æ•°æ®é›†ä¸­æ¯ä¸ªç‚¹åˆ°Kä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»ï¼Œä½¿ç”¨æ¬§æ°è·ç¦»ä½œä¸ºåº¦é‡æ ‡å‡†

     ```python
         def compute_closest_index(self, sample):
             # åŠŸèƒ½ï¼šè®¡ç®—å¹¶è¿”å›æ ·æœ¬sampleè·ç¦»ï¼ˆæ¬§å‡ é‡Œå¾—è·ç¦»ï¼‰æœ€è¿‘çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•
             # è¾“å…¥ï¼š
             #   sampleï¼šè¦è®¡ç®—çš„æ ·æœ¬
             distances = np.sum((self.centers - sample) ** 2, axis=1)
             closest_center_index = np.argmin(distances)
             return closest_center_index
     ```

     å°†æ¯ä¸ªç‚¹åˆ†é…ç»™è·ç¦»å…¶æœ€è¿‘çš„èšç±»ä¸­å¿ƒï¼Œå½¢æˆKä¸ªèšç±»

     ```python
             # 1.å¯¹æ ·æœ¬åˆ¤æ–­æ‰€å±ç°‡
              # 1.1 åˆ›å»ºæ•°ç»„æ¥å­˜å‚¨æ¯ä¸ªæ ·æœ¬çš„ç°‡åˆ†é… 
                 cluster_assignments = np.zeros(self.train_images.shape[0], dtype=int)
                 for i in range(0,self.train_images.shape[0]):
                     # è®¡ç®—æ ·æœ¬åˆ°æ¯ä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»
                     # æ‰¾åˆ°æœ€è¿‘çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•
                     closest_index=self.compute_closest_index(self.train_images[i])
                     cluster_assignments[i]=closest_index
     ```

   * å¯¹äºæ¯ä¸ªèšç±»ï¼Œé‡æ–°è®¡ç®—å…¶èšç±»ä¸­å¿ƒï¼Œå³è®¡ç®—è¯¥èšç±»ä¸­æ‰€æœ‰ç‚¹çš„å‡å€¼ä½œä¸ºæ–°çš„èšç±»ä¸­å¿ƒ(èšç±»å†…æ‰€æœ‰ç‚¹åœ¨æ¯ä¸ªç»´åº¦ä¸Šçš„å‡å€¼æ˜¯è¯¥èšç±»æ–°çš„ä¸­å¿ƒçš„å–å€¼)

     ```python
                 # 2: æ›´æ–°èšç±»ä¸­å¿ƒ
                 new_centers = np.zeros((self.k, self.train_images.shape[1]))
                 for i in range(0,self.k):
                     # æ‰¾åˆ°ç¬¬iç°‡çš„æ‰€æœ‰æ ·æœ¬
                     cluster_i_sample=self.train_images[cluster_assignments==i]
                     # ç°‡ä¸ä¸ºç©ºæ—¶ï¼Œæ›´æ–°èšç±»ä¸­å¿ƒ
                     if cluster_i_sample.size>0:
                         new_centers[i]=cluster_i_sample.mean(axis=0)
                 self.centers=new_centers
                 self.cluster_assignment=cluster_assignments
     ```

3. æµ‹è¯•é˜¶æ®µï¼š

   è®­ç»ƒå‡ºkä¸ªèšç±»ä¸­å¿ƒåï¼Œèšç±»ä¸­å¿ƒåœ¨`self.center`ä¸­çš„ç´¢å¼•å¹¶ä¸ä»£è¡¨èšç±»çš„æ ‡ç­¾ã€‚ç”±äºè®­ç»ƒçš„æ ·æœ¬æ˜¯æœ‰æ ‡ç­¾çš„æ•°æ®ï¼Œåˆ™è¿™é‡Œå–æœ€åä¸€æ¬¡è®­ç»ƒè¿‡ç¨‹ä¸­è¢«åˆ†åˆ°èšç±»å†…çš„è®­ç»ƒæ ·æœ¬çš„æ ‡ç­¾ä¼—æ•°ä¸ºè¯¥èšç±»çš„æ ‡ç­¾ã€‚ï¼ˆè®­ç»ƒæ ·æœ¬çš„è¢«åˆ†é…åˆ°çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•å­˜å‚¨åœ¨`self.cluster_assignment`ä¸­ï¼‰

   ```python
       def test(self,test_labels,test_images):
           # åŠŸèƒ½ï¼šç”¨test_imagesæ ·æœ¬å’Œå®ƒå¯¹åº”çš„æ ‡ç­¾test_labelsæµ‹è¯•æ¨¡å‹ï¼Œè®¡ç®—æ¨¡å‹æ­£ç¡®ç‡
           # è¾“å…¥ï¼š
           #   test_images: æµ‹è¯•æ ·æœ¬
           #   test_labels: æµ‹è¯•æ ·æœ¬çš„æ ‡ç­¾
           correct_sum=0
           for i in range(0,test_images.shape[0]):
                   # 1.è®¡ç®—æ ·æœ¬åˆ°æ¯ä¸ªèšç±»ä¸­å¿ƒçš„è·ç¦»
                   #   æ‰¾åˆ°æœ€è¿‘çš„èšç±»ä¸­å¿ƒçš„ç´¢å¼•
                   closest_index=self.compute_closest_index(test_images[i])
                   # 2. æ‰¾è¯¥èšç±»çš„æ ‡ç­¾ï¼ˆèšç±»å†…æ ·æœ¬æ ‡ç­¾çš„ä¼—æ•°ï¼‰
                   cluster_labels = self.train_labels[self.cluster_assignment == closest_index]
                   mode_result = mode(cluster_labels)
                   predict_label = mode_result.mode[0]  
                   # 3.æ¯”è¾ƒèšç±»æ ‡ç­¾å’Œæ ·æœ¬çœŸå®æ ‡ç­¾
                   if predict_label==test_labels[i]:
                       correct_sum+=1
           accuracy = correct_sum / test_images.shape[0]
           self.test_accuracies.append(accuracy)
   ```

#### (2). å®éªŒç»“æœ

* å®éªŒç»“æœè·å–ï¼š

  * åˆ†åˆ«é‡‡ç”¨ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•åˆå§‹åŒ–å‚æ•°ï¼Œå¹¶ä¸”è®­ç»ƒèšç±»ï¼Œæ¯æ¬¡è®­ç»ƒéƒ½è¿­ä»£50æ¬¡

  * åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼šæ¯éš”5æ¬¡è¿­ä»£å°±ä¼šç”¨`test_image`è®­ç»ƒé›†æµ‹è¯•èšç±»çš„æ­£ç¡®æ€§

  * è®°å½•ä»èšç±»å‚æ•°åˆå§‹åŒ–åˆ°è®­ç»ƒèšç±»ç»“æŸçš„æ€»è®­ç»ƒæ—¶é—´ï¼ˆåŒ…æ‹¬è®­ç»ƒè¿‡ç¨‹ä¸­æµ‹è¯•èšç±»æ­£ç¡®æ€§çš„æ—¶é—´ï¼‰

    ```python
        kmeans_random=Kmeans(10,50,train_labels=train_labels,train_images=train_images)
        start_time = time.time()
        kmeans_random.init_center_distance()
        kmeans_random.train(test_images=test_images,test_labels=test_labels)
        end_time = time.time()
        training_duration = end_time - start_time
        print(f"è®­ç»ƒè¿‡ç¨‹è€—æ—¶ {training_duration:.2f} ç§’")
        print(f"final test accruacy: {kmeans_random.test(test_labels=test_labels,test_images=test_images)}")
        kmeans_random.plot_accuracies("init_random_distance_K_means_Accuracies")
    
    
        kmeans_center=Kmeans(10,50,train_labels=train_labels,train_images=train_images)
        start_time = time.time()
        kmeans_center.init_center_distance()
        kmeans_center.train(test_images=test_images,test_labels=test_labels)
        end_time = time.time()
        training_duration = end_time - start_time
        print(f"è®­ç»ƒè¿‡ç¨‹è€—æ—¶ {training_duration:.2f} ç§’")
        kmeans_center.test(test_labels=test_labels,test_images=test_images)
        print(f"final test accruacy: {kmeans_random.test(test_labels=test_labels,test_images=test_images)}")
        kmeans_center.plot_accuracies("init_center_distance_K_means_Accuracies")
    ```

* å®éªŒç»“æœï¼š

  |                              | éšæœºåˆå§‹åŒ–èšç±»ä¸­å¿ƒ                                           | æ ¹æ®è·ç¦»åˆå§‹åŒ–èšç±»ä¸­å¿ƒ                                       |
  | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | è®­ç»ƒæ€»æ—¶é•¿                   | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209221059308.png" alt="image-20241209221059308" style="zoom:60%;" /> | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209221117873.png" alt="image-20241209221117873" style="zoom:67%;" /> |
  | è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ­£ç¡®ç‡           | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209220303128.png" alt="image-20241209220303128" style="zoom:50%;" /><br /><img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209220904109.png" alt="image-20241209220904109" style="zoom:50%;" /> | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209220428987.png" alt="image-20241209220428987" style="zoom:50%;" /><br /><img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209221011901.png" alt="image-20241209221011901" style="zoom:50%;" /> |
  | è®­ç»ƒå®Œçš„èšç±»å¯¹æµ‹è¯•é›†çš„æ­£ç¡®ç‡ | 60.01%<br /><br /><img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209220942379.png" alt="image-20241209220942379" style="zoom:50%;" /> | 60.01%<br /><img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241209221040117.png" alt="image-20241209221040117" style="zoom:50%;" /> |
  |                              |                                                              |                                                              |

* å®éªŒç»“æœåˆ†æï¼š

  * è®­ç»ƒæ€»æ—¶é•¿ï¼šéšæœºåˆå§‹åŒ–èšç±»ä¸­å¿ƒæ¯”æ ¹æ®è·ç¦»åˆå§‹åŒ–èšç±»ä¸­å¿ƒçŸ­ã€‚

    åŸå› ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–èšç±»ä¸­å¿ƒåœ¨åˆå§‹åŒ–é˜¶æ®µéœ€è¦è¿­ä»£å¯¹æ¯ä¸ªæ ·æœ¬è¿›è¡Œå’Œèšç±»ä¸­å¿ƒçš„è·ç¦»è®¡ç®—ï¼Œåˆ™è€—æ—¶è¾ƒé•¿

  * æ­£ç¡®ç‡ï¼š

    * è®­ç»ƒå¼€å§‹æ—¶çš„æ­£ç¡®ç‡ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–æ¯”éšæœºåˆå§‹åŒ–çš„æ­£ç¡®ç‡é«˜

      åŸå› ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–çš„åˆå§‹èšç±»ä¸­å¿ƒå°½å¯èƒ½åˆ†æ•£ï¼Œå¯èƒ½æ›´æ¥è¿‘çœŸå®æ ·æœ¬çš„åˆ†ç±»

    * è®­ç»ƒè¿‡ç¨‹çš„æ­£ç¡®ç‡ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–åœ¨ç¬¬10æ¬¡è¿­ä»£æ”¶æ•›è¾¾åˆ°æœ€é«˜å€¼60.62%æ¯”éšæœºåˆå§‹åŒ–çš„ç¬¬45æ¬¡è¿­ä»£60.11%æ›´å¿«ä¸”æ­£ç¡®ç‡æ›´é«˜ã€‚æ ¹æ®è·ç¦»åˆå§‹åŒ–åœ¨15æ¬¡è¿­ä»£å·¦å³å¼€å§‹ä¼šç”±äºè¿­ä»£æ¬¡æ•°è¿‡å¤šå‡ºç°è¿‡æ‹Ÿåˆå¯¼è‡´æ­£ç¡®ç‡ä¸‹é™
      åŸå› ï¼šæ ¹æ®è·ç¦»åˆå§‹åŒ–çš„åˆå§‹èšç±»ä¸­å¿ƒå°½å¯èƒ½åˆ†æ•£ï¼Œå¯èƒ½æ›´æ¥è¿‘çœŸå®æ ·æœ¬çš„åˆ†ç±»
    * æœ€ç»ˆæ­£ç¡®ç‡ï¼šä¸¤ä¸ªåˆå§‹åŒ–æ–¹æ³•çš„æ­£ç¡®ç‡ç›¸è¿‘ç”šè‡³ç›¸åŒ

## ä¸‰ï¼šEMç®—æ³•è®­ç»ƒGMMæ¨¡å‹

#### (1).ç®—æ³•æµç¨‹

GMMæ¨¡å‹ï¼šp(x|Î¸)=âˆ‘k=1KÏ€kğ’©(x|Î¼k,Î£k)

* GMMåŒ…å«Kä¸ªå‚æ•°æ¨¡å‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè¿™äº›å‡½æ•°çš„åŠ æƒç»„åˆæ„æˆäº†GMMçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚
* åœ¨GMMä¸­ï¼Œæ¯ä¸ªé«˜æ–¯åˆ†å¸ƒéƒ½ä»£è¡¨äº†ä¸€ä¸ªèšç±»ï¼Œè€Œæ•´ä¸ªæ¨¡å‹åˆ™èƒ½å¤Ÿæè¿°æ•°æ®çš„å¤šå³°åˆ†å¸ƒç‰¹æ€§ã€‚
* GMMå¼•å…¥äº†éšå˜é‡zï¼Œç”¨äºè¡¨ç¤ºæ•°æ®å±äºå“ªä¸€ä¸ªèšç±»ã€‚

* è®¡ç®—æ ·æœ¬åœ¨é«˜æ–¯åˆ†å¸ƒä¸­çš„æ¦‚ç‡

  ```python
          mvn = multivariate_normal(self.means[index], self.covariance_matrices[index])
          return mvn.pdf(sample)
  ```

1. åˆå§‹åŒ–ï¼š

   * é«˜æ–¯åˆ†å¸ƒçš„æ•°é‡ï¼šæŒ‡å®šä¸º10

   * æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼ï¼šåŒä¸Šé¢çš„kmeansè·å–10ä¸ªèšç±»ä¸­å¿ƒçš„ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•ï¼šéšæœºåˆå§‹åŒ–å’Œæ ¹æ®è·ç¦»åˆå§‹åŒ–

     ```python
             # 2. åˆå§‹åŒ–æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼
             #   éšæœºæŠ½å–kä¸ªæ ·æœ¬åˆå§‹åŒ–å‡å€¼
             if(means_init_method==0):
                 init_num = np.random.choice(self.train_images.shape[0], self.k, replace=False)
                 self.means= self.train_images[init_num]
             # æ ¹æ®è·ç¦»æ¥é€‰æ‹©å“ªä¸ªæ ·æœ¬ä½œä¸ºé«˜æ–¯åˆ†å¸ƒçš„åˆå§‹åŒ–å‡å€¼
             elif(means_init_method==1):
                 # é€‰æ‹©ç¬¬ä¸€ä¸ªå¹³å‡å€¼ä¸ºéšæœºæ ·æœ¬
                 self.means = np.zeros((self.k, self.train_images.shape[1]))
                 self.means[0] = self.train_images[np.random.choice(self.train_images.shape[0])]
                 # è®¡ç®—æ‰€æœ‰ç‚¹åˆ°ç¬¬ä¸€ä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»
                 distances = np.linalg.norm(self.train_images - self.means[0], axis=1)
                 # é€‰æ‹©å‰©ä½™çš„ä¸­å¿ƒç‚¹
                 for i in range(1, self.k):
                     # é€‰æ‹©ä¸å·²æœ‰ä¸­å¿ƒç‚¹è·ç¦»æœ€è¿œçš„ç‚¹ä½œä¸ºæ–°çš„ä¸­å¿ƒç‚¹
                     farthest_index = np.argmax(distances)
                     self.means[i] = self.train_images[farthest_index]
                     # æ›´æ–°è·ç¦»ï¼Œè€ƒè™‘æ–°ä¸­å¿ƒç‚¹
                     new_distances = np.linalg.norm(self.train_images - self.means[i], axis=1)
                     # æ›´æ–°åˆ°æ–°ä¸­å¿ƒç‚¹çš„è·ç¦»
                     distances = np.minimum(distances, new_distances)
     ```

   * æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„æƒé‡ï¼šéšæœºç”Ÿæˆæ•´æ•°å¹¶å½’ä¸€åŒ–çš„æ–¹æ³•

     ```python
             random_weights = np.random.randint(0, 101, size=10)
             weights_sum = np.sum(random_weights.astype(float))
             self.weights = random_weights.astype(float) / weights_sum
     ```

   * æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„åæ–¹å·®çŸ©é˜µï¼š
     * æ³•ä¸€ï¼šä½¿ç”¨æ ·æœ¬çš„åæ–¹å·®çŸ©é˜µçš„å¯¹è§’çŸ©é˜µè¿›è¡Œåˆå§‹åŒ–
     
       ```python
               # 3. åˆå§‹åŒ–æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒæ˜¯åæ–¹å·®çŸ©é˜µ
               # è¦åˆå§‹åŒ–ä¸ºæ ·æœ¬çš„åæ–¹å·®çŸ©é˜µçš„å¯¹è§’çŸ©é˜µ(å¯¹è§’å…ƒç´ ä¸åŒ)
               if(cov_init_method==0):
                   cov = np.cov(self.train_images, rowvar=False) + 1e-6 * np.eye(self.train_images.shape[1])
                   cov = np.diag(np.diag(cov))
                   self.covariance_matrices= cov[np.newaxis, :].repeat(self.k, axis=0)
       ```
     
     * æ³•äºŒï¼šå§‹åŒ–ä¸ºä¸€ä¸ªæ‰€æœ‰å¯¹è§’å…ƒç´ ç›¸ç­‰çš„å¯¹è§’çŸ©é˜µã€‚
     
       ```python
               # 3. åˆå§‹åŒ–æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒæ˜¯åæ–¹å·®çŸ©é˜µ
                   #åˆå§‹åŒ–å¯¹è§’çŸ©é˜µå…ƒç´ éƒ½ç›¸ç­‰ï¼Œçƒå½¢åˆå§‹åŒ–
                   avg_var = np.mean(np.var(self.train_images, axis=0))
                   cov = avg_var * np.ones((self.train_images.shape[1], self.train_images.shape[1]))
                   # ç”±äºcovéœ€è¦æ˜¯å¯¹è§’çŸ©é˜µï¼Œè¿™é‡Œä»ä½¿ç”¨å¯¹è§’çŸ©é˜µå½¢å¼
                   cov = np.diag(np.full(self.train_images.shape[1], avg_var))
                   self.covariance_matrices = cov[np.newaxis, :].repeat(self.k, axis=0)
       ```

2. EMç®—æ³•è¿­ä»£ï¼š

   æ¯æ¬¡è¿­ä»£äº¤æ›¿åšE-Mæ­¥

   * Eæ­¥ï¼š

     * é€šè¿‡è®¡ç®—æ¯ä¸ªæ ·æœ¬åœ¨æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒä¸‹çš„åéªŒæ¦‚ç‡ï¼ˆå·²çŸ¥æ ·æœ¬xï¼Œxåœ¨ç¬¬iä¸ªé«˜æ–¯åˆ†å¸ƒä¸­å‡ºç°çš„æ¦‚ç‡ï¼‰æ¥è®¡ç®—è½åœ¨ç¬¬kä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡

     $$
     \gamma_{jk}=E_{p(z|x;\theta^{(t)}[z_k])} = \frac{\alpha_k N(x|\mu_k,\Sigma_k)}{\sum_{l=1}^{K}\alpha_l N(x|\mu_l,\Sigma_l)}=p(z=1_k|x;\theta^{(t)})
     $$

     â€‹	å…¶ä¸­ï¼Œ$N(x_j|\mu_k,\Sigma_k)$â€‹æ˜¯æ ·æœ¬`x_j`åœ¨ç¬¬`k`ä¸ªé«˜æ–¯åˆ†å¸ƒä¸‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚

     ```python
                 # 1.è®¡ç®—gamma
                 gamma_matrix=np.zeros((self.train_images.shape[0],self.k))
                 for j in range(0,self.k):
                     # ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰æ ·æœ¬çš„æ¦‚ç‡å¯†åº¦
                     gamma_matrix[:, j] = self.Gaussion_probability(j,self.train_images) * self.weights[j]
                 #print(gamma_matrix)
                 gamma_matrix/=gamma_matrix.sum(axis=1,keepdims=True) #æŒ‰è¡Œæ±‚å’Œä¿æŒç»´åº¦
     ```

   * Mæ­¥ï¼šNä¸ºæ ·æœ¬ç‰¹å¾å€¼ç»´åº¦

     * æ ¹æ®Eæ­¥å¾—åˆ°çš„Î³çŸ©é˜µï¼Œæ›´æ–°é«˜æ–¯åˆ†å¸ƒçš„å‚æ•°ï¼ˆæƒé‡ã€å‡å€¼ã€åæ–¹å·®çŸ©é˜µï¼‰ã€‚

     * è®¡ç®—`N_k`: $$ N_k=\sum_{j=1}^{N}\gamma_{jk}$$â€‹

       ```python
       N=np.sum(gamma_matrix,axis=0) #æŒ‰è¡Œæ±‚å’Œ
       ```

       

     * æ›´æ–°æƒé‡`Î±_k`ï¼š$$\alpha_k = \frac{N_k}{N}$$â€‹

       ```python
       self.weights[i]=N[i]/self.train_images.shape[0]
       ```

       

     * æ›´æ–°æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼`u_k`ï¼š$$\mu_k = \frac{\sum_{j=1}^{N}\gamma_{jk}x_j}{N_k}$$â€‹

       ```python
       self.means[i]=(1/N[i])*np.dot(gamma_matrix[:,i].reshape(1,-1),self.train_images) 
       ```

       

     * æ›´æ–°åæ–¹å·®çŸ©é˜µ`Î£_k`ï¼š

       $$ \Sigma_k = \frac{\sum_{j=1}^{N}\gamma_{jk}(x_j - \mu_k)^T(x_j - \mu_k)}{N_k} $$â€‹

       ```python
       covariance_matrix = (1 / (N[i] + 1e-6)) * np.dot((gamma_matrix[:, i].reshape(-1, 1) * diff).T, diff)                
       self.covariance_matrices[i]=covariance_matrix
       ```

3. æµ‹è¯•é˜¶æ®µï¼šåŒk_meansä¸­çš„æµ‹è¯•æ–¹æ³•ï¼Œç”¨æœ€åä¸€æ¬¡è®­ç»ƒçš„åˆ†åˆ°å„ä¸ªé«˜æ–¯åˆ†å¸ƒçš„è®­ç»ƒæ ·æœ¬çš„æ ‡ç­¾ä¼—æ•°ä¸ºè¯¥é«˜æ–¯åˆ†å¸ƒçš„é¢„æµ‹æ ‡ç­¾ã€‚è®¡ç®—æµ‹è¯•æ ·æœ¬åœ¨å„ä¸ªé«˜æ–¯åˆ†å¸ƒä¸‹çš„æ¦‚ç‡ï¼Œå–æœ€å¤§æ¦‚ç‡çš„é«˜æ–¯åˆ†å¸ƒçš„æ‰€å±æ ‡ç­¾ä¸ºæµ‹è¯•æ ·æœ¬çš„é¢„æµ‹æ ‡ç­¾

   ```python
       def test(self,test_images,test_labels):
           # åŠŸèƒ½ï¼šå·²çŸ¥xæ±‚å±äºå“ªä¸ªèšç±»z
           correct_sum=0
           gamma_vector=np.zeros((test_images.shape[0],self.k))
           for j in range(0,self.k):
                   # è®¡ç®—æ¯ä¸ªæ ·æœ¬åœ¨ç¬¬jä¸ªé«˜æ–¯åˆ†å¸ƒä¸‹çš„æ¦‚ç‡    
               gamma_vector[:, j] = self.Gaussion_probability(j, test_images) * self.weights[j]
   
           gamma_vector /= np.sum(gamma_vector, axis=1, keepdims=True)
           predict_test_indexs=np.argmax(gamma_vector,axis=1)
           for i in range(0,test_images.shape[0]):
               cluster_labels = self.train_labels[self.predict_indexs == predict_test_indexs[i]]
               mode_result = mode(cluster_labels)
               predict_label = mode_result.mode[0] 
               #print(i)
               if predict_label == test_labels[i]:
                   correct_sum += 1
           
           accuracy = correct_sum / test_images.shape[0]
           self.test_accuracies.append(accuracy)
           return accuracy
   ```

#### (2). å®éªŒç»“æœ

å¯¹ä¸Šè¿°æåˆ°çš„ä¸åŒåˆå§‹åŒ–æ–¹æ³•åˆ†åˆ«è®­ç»ƒè¿­ä»£100æ¬¡ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ¯éš”5æ¬¡è¿­ä»£ç”¨æµ‹è¯•é›†æµ‹è¯•æ¨¡å‹çš„æ­£ç¡®ç‡ã€‚
<img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165220618.png" alt="image-20241210165220618" style="zoom:80%;" />

|                                                              | éšæœºåˆå§‹åŒ–é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼                                     | æ ¹æ®è·ç¦»åˆå§‹åŒ–é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ä»¥è®­ç»ƒæ ·æœ¬çš„åæ–¹å·®çŸ©é˜µçš„å¯¹è§’çŸ©é˜µä¸ºé«˜æ–¯åˆ†å¸ƒçš„åæ–¹å·®çŸ©é˜µ       | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165023560.png" alt="image-20241210165023560" style="zoom:50%;" /><br />æ”¶æ•›é€Ÿåº¦ï¼šæœ€æ…¢ | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165054131.png" alt="image-20241210165054131" style="zoom:50%;" /><br />è®­ç»ƒæ—¶é—´æœ€é•¿ï¼šè®¡ç®—è®­ç»ƒæ ·æœ¬å‘¢çš„åæ–¹å·®çŸ©é˜µå’Œè®¡ç®—æ¯ä¸ªæ ·æœ¬åˆ°èšç±»çš„è·ç¦»èŠ±è´¹çš„æ—¶é—´æœ€é•¿<br />æ­£ç¡®ç‡ï¼šæœ€é«˜ |
| ä»¥è®­ç»ƒæ ·æœ¬æŸä¸ªç»´åº¦çš„å¹³å‡å€¼ä¸ºå¯¹è§’çŸ©é˜µçš„å…ƒç´ çš„å¯¹è§’çŸ©é˜µä¸ºé«˜æ–¯åˆ†å¸ƒçš„åæ–¹å·®çŸ©é˜µ | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165036618.png" alt="image-20241210165036618" style="zoom:50%;" /><br />æœ€å¿«æ”¶æ•› | <img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165110325.png" alt="image-20241210165110325" style="zoom:50%;" /><br /><img src="C:/Users/ä¸æ™“çª/AppData/Roaming/Typora/typora-user-images/image-20241210165140103.png" alt="image-20241210165140103" style="zoom:67%;" /><br />æ­£ç¡®ç‡ï¼šæœ€ä½ï¼Œä¸”æ¯”kmeansç•¥ä½ |



## å››ï¼šEMç®—æ³•è®­ç»ƒGMM VS Kmeans

* å®ç°ï¼šK_meanså®ç°ç®€å•ï¼Œä¸»è¦éœ€è¦è°ƒæ•´çš„å‚æ•°ä»…ä¸ºç°‡çš„æ•°é‡Kã€‚EMç®—æ³•è®­ç»ƒGMMå®ç°è¾ƒä¸ºå¤æ‚ï¼Œå‚æ•°åŒ…å«å‡å€¼ã€åæ–¹å·®å’Œæ··åˆç³»æ•°
* æ•ˆç‡ï¼š
  * K_meansè®¡ç®—å¤æ‚åº¦ä½ï¼Œåªéœ€è¦è®¡ç®—æ ·æœ¬é—´çš„è·ç¦»ï¼Œæ±‚å’Œï¼Œå–æœ€å¤§æœ€å°å€¼ç­‰ç®€å•è®¡ç®—ï¼Œæ‰€ä»¥è®­ç»ƒé€Ÿåº¦å¿«ã€‚
  * EMè®­ç»ƒGMMèšç±»è®¡ç®—å¤æ‚åº¦é«˜ï¼šéœ€è¦è®¡ç®—åæ–¹å·®çŸ©é˜µï¼Œæ±‚ç‰¹å¾å€¼ç‰¹å¾å‘é‡ç­‰å¤æ‚è®¡ç®—ï¼Œè®­ç»ƒé€Ÿåº¦ä½
* æ”¶æ•›é€Ÿåº¦ï¼šK_meansçš„æ”¶æ•›é€Ÿåº¦å¿«ï¼Œ50æ¬¡ä¹‹å†…æ”¶æ•›ã€‚EMè®­ç»ƒGMMçš„æ”¶æ•›é€Ÿåº¦æ…¢ï¼Œ50æ¬¡å†…æ— æ³•æ”¶æ•›
* æ­£ç¡®ç‡ï¼šåœ¨æœ¬æ¬¡å®éªŒä¸­ï¼ŒEMç®—æ³•è®­ç»ƒGMMæ¨¡å‹åœ¨æµ‹è¯•é›†è¾¾åˆ°çš„æœ€ç»ˆæ¨¡å‹æ­£ç¡®ç‡æ›´é«˜ï¼Œ
  * GMMæ¨¡å‹èƒ½å¤Ÿå¤„ç†ç°‡å½¢çŠ¶ä¸è§„åˆ™ã€å¤§å°ä¸ä¸€çš„æ•°æ®é›†ã€‚
  * æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œåæ–¹å·®çŸ©é˜µå†³å®šäº†å¯¹åº”èšç±»çš„ä½ç½®å’Œå½¢çŠ¶ï¼Œå› æ­¤GMMæ¨¡å‹èƒ½å¤Ÿçµæ´»åœ°é€‚åº”ä¸åŒå½¢çŠ¶çš„èšç±»ã€‚


â€‹		



